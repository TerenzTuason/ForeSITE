<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Learning Style Questionnaire - ForeSITE</title>
    <!-- Google Fonts -->
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap"
      rel="stylesheet"
    />
    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <!-- Font Awesome -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />
    <style>
      :root {
        --maroon: #800000;
        --gold: #ffb81c;
      }
      body {
        background-color: #f5f5f5;
        font-family: "Poppins", sans-serif;
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 2rem 0;
      }
      
      .text-maroon {
        color: var(--maroon);
      }

      .text-gold {
        color: var(--gold);
      }

      .modal-content {
        border-radius: 12px;
        border: none;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
      }

      .learning-style-badge {
        background-color: var(--maroon);
        color: white;
        border-radius: 8px;
        text-transform: uppercase;
        font-weight: 600;
        box-shadow: 0 4px 10px rgba(128, 0, 0, 0.2);
      }
      
      /* We're removing the roulette styles from here since they will now be on the dashboard page */
      .questionnaire-container {
        max-width: 800px;
        margin: 0 auto;
        background: white;
        border-radius: 8px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        padding: 2rem;
      }
      .section-header {
        color: var(--maroon);
        font-weight: 600;
        margin-bottom: 1.5rem;
        padding-bottom: 0.5rem;
        border-bottom: 2px solid var(--gold);
      }
      .instructions {
        background-color: #f8f9fa;
        padding: 1.5rem;
        border-radius: 8px;
        margin-bottom: 2rem;
      }
      .form-label {
        font-weight: 500;
        color: #333;
      }
      .form-control:focus {
        border-color: var(--maroon);
        box-shadow: none;
      }
      .form-check {
        margin: 0.5rem 0;
      }
      .form-check-input {
        width: 1.2rem;
        height: 1.2rem;
        margin-top: 0.25rem;
        border: 2px solid #666;
        cursor: pointer;
      }
      .form-check-input:checked {
        background-color: var(--maroon);
        border-color: var(--maroon);
      }
      .form-check-label {
        padding-left: 0.5rem;
        color: #333;
        font-weight: 500;
        cursor: pointer;
      }
      .form-check-inline {
        margin-right: 2rem;
      }
      .question-item {
        padding: 1rem;
        border-bottom: 1px solid #eee;
        margin-bottom: 1rem;
        background-color: #fff;
      }
      .question-item:hover {
        background-color: #f8f9fa;
      }
      .btn-submit {
        background-color: var(--maroon);
        border: none;
        padding: 0.75rem 2rem;
        font-weight: 500;
        color: white;
      }
      .btn-submit:hover {
        background-color: #600000;
        color: white;
      }
      .progress {
        height: 0.5rem;
        margin-bottom: 2rem;
      }
      .progress-bar {
        background-color: var(--maroon);
      }
      @media (max-width: 768px) {
        .questionnaire-container {
          margin: 1rem;
          padding: 1.5rem;
        }
      }

      /* Navbar Styles */
      .navbar {
        background: var(--maroon);
        padding: 1rem 0;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }

      .navbar-brand {
        color: white !important;
        font-weight: 600;
        font-size: 1.2rem;
        display: flex;
        align-items: center;
        gap: 0.75rem;
      }

      .navbar-brand img {
        height: 35px;
      }

      .nav-link {
        color: rgba(255, 255, 255, 0.9) !important;
        font-weight: 500;
        transition: color 0.3s ease;
        padding: 0.5rem 1rem !important;
      }

      .nav-link:hover {
        color: var(--gold) !important;
      }

      .nav-link.btn-logout {
        background-color: var(--gold);
        color: var(--maroon) !important;
        border-radius: 50px;
        padding: 0.5rem 1.5rem !important;
        margin-left: 1rem;
        font-weight: 600;
        transition: all 0.3s ease;
      }

      .nav-link.btn-logout:hover {
        background-color: #fff;
        color: var(--maroon) !important;
        transform: translateY(-2px);
      }

      @media (max-width: 768px) {
        .navbar-brand {
          font-size: 1rem;
        }
        .navbar-brand img {
          height: 30px;
        }
        .navbar-brand .d-none {
          display: none;
        }
      }
    </style>
  </head>
  <body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg fixed-top">
      <div class="container">
        <a class="navbar-brand d-flex align-items-center" href="#">
          <img src="../assets/logo/pup.png" alt="PUP Logo" class="me-2" />
          <span class="d-none d-sm-inline"
            >FORESITE: Adaptive Collaborative Learning System</span
          >
          <span class="d-inline d-sm-none">FORESITE</span>
        </a>
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarNav"
          aria-controls="navbarNav"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div
          class="collapse navbar-collapse justify-content-end"
          id="navbarNav"
        >
          <ul class="navbar-nav align-items-center">
            <li class="nav-item">
              <a class="nav-link" href="#"
                ><i class="fas fa-user-circle me-1"></i> Profile</a
              >
            </li>
            <li class="nav-item">
              <a class="nav-link btn-logout" href="../login.html"
                ><i class="fas fa-sign-out-alt me-1"></i> Logout</a
              >
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <div class="container" style="margin-top: 100px">
      <div class="questionnaire-container">
        <h1 class="section-header text-center mb-4">
          Learning Style Assessment
        </h1>

        <div class="progress">
          <div
            class="progress-bar"
            role="progressbar"
            style="width: 0%"
            aria-valuenow="0"
            aria-valuemin="0"
            aria-valuemax="100"
          ></div>
        </div>

        <form id="questionnaireForm">
          <!-- Profile Section -->
          <section id="profileSection">
            <h2 class="section-header">Personal Information</h2>
            <div class="row g-3 mb-4">
              <div class="col-md-6">
                <label class="form-label">First Name</label>
                <input
                  type="text"
                  class="form-control"
                  required
                  placeholder="First Name"
                />
              </div>
              <div class="col-md-6">
                <label class="form-label">Last Name</label>
                <input
                  type="text"
                  class="form-control"
                  required
                  placeholder="Last Name"
                />
              </div>
              <div class="col-12">
                <label class="form-label">Department</label>
                <input
                  type="text"
                  class="form-control"
                  required
                  placeholder="Department"
                />
              </div>
            </div>
          </section>

          <!-- Learning Style Questionnaire Section -->
          <section id="questionnaireSection" style="display: none">
            <h2 class="section-header">
              Honey and Mumford Learning Styles Questionnaire
            </h2>

            <div class="instructions">
              <h5 class="mb-3">Instructions:</h5>
              <p>
                This questionnaire will help identify your preferred learning
                style(s). There are no right or wrong answers. For each
                statement:
              </p>
              <ul>
                <li>Select "Agree" if you agree more than you disagree</li>
                <li>Select "Disagree" if you disagree more than you agree</li>
              </ul>
              <p class="mb-0">
                Please answer all questions honestly for the most accurate
                results.
              </p>
            </div>

            <div id="questionsContainer">
              <!-- Questions will be dynamically added here -->
            </div>
          </section>

          <!-- Navigation Buttons -->
          <div class="d-flex justify-content-between mt-4">
            <button
              type="button"
              class="btn btn-outline-secondary"
              id="prevBtn"
              style="display: none"
            >
              Previous
            </button>
            <button type="button" class="btn btn-submit" id="nextBtn">
              Next
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- We're removing the modal from here since it will now be on the dashboard page -->

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      const questions = [
        "I have strong beliefs about what is right and wrong, good and bad.",
        "I often act without considering the possible consequences",
        "I tend to solve problems using a step-by-step approach",
        "I believe that formal procedures and policies restrict people",
        "I have a reputation for saying what I think, simply and directly",
        "I often find that actions based on feelings are as sound as those based on careful thought and analysis",
        "I like the sort of work where I have time for thorough preparation and implementation",
        "I regularly question people about their basic assumptions",
        "What matters most is whether something works in practice",
        "I actively seek out new experiences",
        "When I hear about a new idea or approach I immediately start working out how to apply it in practice",
        "I am keen on self discipline such as watching my diet, taking regular exercise, sticking to a fixed routine, etc.",
        "I take pride in doing a thorough job",
        "I get on best with logical, analytical people and less well with spontaneous, 'irrational'",
        "I take care over the interpretation of data available to me and avoid jumping to conclusions",
        "I like to reach a decision carefully after weighing up many alternatives",
        "I'm attracted more to novel, unusual ideas than to practical ones",
        "I don't like disorganised things and prefer to fit things into a coherent pattern",
        "I accept and stick to laid down procedures and policies so long as I regard them as an efficient way of getting the job done",
        "I like to relate my actions to a general principle",
        "In discussions I like to get straight to the point",
        "I tend to have distant, rather formal relationships with people at work",
        "I thrive on the challenge of tackling something new and different",
        "I enjoy fun-loving, spontaneous people",
        "I pay meticulous attention to detail before coming to a conclusion",
        "I find it difficult to produce ideas on impulse",
        "I believe in coming to the point immediately",
        "I am careful not to jump to conclusions too quickly",
        "I prefer to have as many resources of information as possible - the more data to think over the better",
        "Flippant people who don't take things seriously enough usually irritate me",
        "I listen to other people's points of view before putting my own forward",
        "I tend to be open about how I'm feeling",
        "In discussions I enjoy watching the manoeuvrings of the other participants",
        "I prefer to respond to events on a spontaneous, flexible basis rather than plan things out in advance",
        "I tend to be attracted to techniques such as network analysis, flow charts, branching programs, contingency planning, etc.",
        "It worries me if I have to rush out a piece of work to meet a tight deadline",
        "I tend to judge people's ideas on their practical merits",
        "Quiet, thoughtful people tend to make me feel uneasy",
        "I often get irritated by people who want to rush things",
        "It is more important to enjoy the present moment than to think about the past or future",
        "I think that decisions based on a thorough analysis of all the information are sounder than those based on intuition",
        "I tend to be a perfectionist",
        "In discussions I usually produce lots of spontaneous ideas",
        "In meetings I put forward practical realistic ideas",
        "More often than not, rules are there to be broken",
        "I prefer to stand back from a situation",
        "I can often see inconsistencies and weaknesses in other people's arguments",
        "On balance I talk more than I listen",
        "I can often see better, more practical ways to get things done",
        "I think written reports should be short and to the point",
        "I believe that rational, logical thinking should win the day",
        "I tend to discuss specific things with people rather than engaging in social discussion",
        "I like people who approach things realistically rather than theoretically",
        "In discussions I get impatient with irrelevancies and digressions",
        "If I have a report to write I tend to produce lots of drafts before settling on the final version",
        "I am keen to try things out to see if they work in practice",
        "I am keen to reach answers via a logical approach",
        "I enjoy being the one that talks a lot",
        "In discussions I often find I am the realist, keeping people to the point and avoiding wild speculations",
        "I like to ponder many alternatives before making up my mind",
        "In discussions with people I often find I am the most dispassionate and objective",
        "In discussions I'm more likely to adopt a 'low profile' than to take the lead and do most of the talking",
        "I like to be able to relate current actions to a longer term bigger picture",
        "When things go wrong I am happy to shrug it off and 'put it down to experience'",
        "I tend to reject wild, spontaneous ideas as being impractical",
        "It's best to think carefully before taking action",
        "On balance I do the listening rather than the talking",
        "I tend to be tough on people who find it difficult to adopt a logical approach",
        "Most times I believe the end justifies the means",
        "I don't mind hurting people's feelings so long as the job gets done",
        "I find the formality of having specific objectives and plans stifling",
        "I'm usually one of the people who puts life into a party",
        "I do whatever is expedient to get the job done",
        "I quickly get bored with methodical, detailed work",
        "I am keen on exploring the basic assumptions, principles and theories underpinning things and events",
        "I'm always interested to find out what people think",
        "I like meetings to be run on methodical lines, sticking to laid down agenda, etc.",
        "I steer clear of subjective or ambiguous topics",
        "I enjoy the drama and excitement of a crisis situation",
        "People often find me insensitive to their feelings",
      ];

      let currentSection = "profile";
      const questionsPerPage = 10;
      let currentQuestionPage = 0;
      // Add storage for answers
      const savedAnswers = new Array(questions.length).fill(null);

      // Pre-fill answers for testing (1 for agree, 0 for disagree)
      // const savedAnswers = Array(questions.length).fill(0).map((_, index) => index % 2); // Alternates between 0 and 1

      // Pre-fill answers for Reflector style
      //   const savedAnswers = [
      //     0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0,
      //     1, 1, 0, 1, 1, 0, 1, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 1, 0, 0,
      //     0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0,
      //     0, 0, 0, 1, 1, 0, 0, 0,
      //   ];

      // Pre-fill answers for Pragmatist style
      // const savedAnswers = [
      //   0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0,
      //   0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0,
      //   1, 1, 0, 0, 1, 1, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 1, 1, 1, 0, 0,
      //   1, 1, 0, 0, 0, 0, 0, 1,
      // ];

      // Add a console log to show the request body that will be sent
      console.log("Request body that will be sent:", { answers: savedAnswers });

      document.addEventListener("DOMContentLoaded", function () {
        // Get user data from session storage
        const userData = JSON.parse(sessionStorage.getItem("user"));
        if (!userData) {
          // Redirect to login if no user data found
          window.location.href = "../login.html";
          return;
        }

        // Add logout functionality
        const logoutBtn = document.querySelector('.btn-logout');
        logoutBtn.addEventListener('click', function(e) {
          e.preventDefault();
          sessionStorage.removeItem('user');
          window.location.href = '../login.html';
        });

        // Check if user has already taken the assessment
        fetch(`http://127.0.0.1:8000/api/v1/users/${userData.user_id}/assessment-results`)
          .then(response => response.json())
          .then(data => {
            if (data.data && data.data.length > 0) {
              // User has already taken the assessment, redirect to enrollment page
              window.location.href = "dashboard.html";
              return;
            }
            // Continue with the rest of the code if no assessment results found
            initializeQuestionnaire();
          })
          .catch(error => {
            console.error('Error checking assessment results:', error);
          });

        function initializeQuestionnaire() {
          // Pre-fill personal information fields
          document.querySelector('input[placeholder="First Name"]').value =
            userData.first_name;
          document.querySelector('input[placeholder="Last Name"]').value =
            userData.last_name;

          // Make name fields readonly since they come from session
          document.querySelector(
            'input[placeholder="First Name"]'
          ).readOnly = true;
          document.querySelector(
            'input[placeholder="Last Name"]'
          ).readOnly = true;

          const nextBtn = document.getElementById("nextBtn");
          const prevBtn = document.getElementById("prevBtn");
          const profileSection = document.getElementById("profileSection");
          const questionnaireSection = document.getElementById(
            "questionnaireSection"
          );
          const questionsContainer =
            document.getElementById("questionsContainer");
          const progressBar = document.querySelector(".progress-bar");

          function showQuestions(page) {
            const start = page * questionsPerPage;
            const end = start + questionsPerPage;
            const currentQuestions = questions.slice(start, end);

            questionsContainer.innerHTML = currentQuestions
              .map((question, index) => {
                const questionNumber = start + index + 1;
                const savedAnswer = savedAnswers[start + index];
                return `
                      <div class="question-item">
                          <p class="mb-2"><strong>Q${questionNumber}.</strong> ${question}</p>
                          <div class="form-check form-check-inline">
                              <input class="form-check-input" type="radio" name="q${questionNumber}" value="agree" required ${
                savedAnswer === 1 ? "checked" : ""
              }>
                              <label class="form-check-label">Agree</label>
                          </div>
                          <div class="form-check form-check-inline">
                              <input class="form-check-input" type="radio" name="q${questionNumber}" value="disagree" required ${
                savedAnswer === 0 ? "checked" : ""
              }>
                              <label class="form-check-label">Disagree</label>
                          </div>
                      </div>
                  `;
              })
              .join("");

            // Add change event listeners to save answers
            const radios = questionsContainer.querySelectorAll(
              'input[type="radio"]'
            );
            radios.forEach((radio) => {
              radio.addEventListener("change", function () {
                const questionNum = parseInt(this.name.substring(1)) - 1;
                savedAnswers[questionNum] = this.value === "agree" ? 1 : 0;
              });
            });

            updateProgress();
          }

          function getPageAnswers(page) {
            const start = page * questionsPerPage;
            const end = start + questionsPerPage;
            return savedAnswers.slice(start, end);
          }

          function logAnswers(page) {
            const start = page * questionsPerPage + 1;
            const end = start + questionsPerPage - 1;
            const answers = getPageAnswers(page);
            console.log(`Q${start} to Q${end} - [${answers.join(",")}]`);
          }

          function updateProgress() {
            const totalPages = Math.ceil(questions.length / questionsPerPage);
            const progress =
              currentSection === "profile"
                ? 0
                : ((currentQuestionPage + 1) / (totalPages + 1)) * 100;
            progressBar.style.width = `${progress}%`;
            progressBar.setAttribute("aria-valuenow", progress);
          }

          nextBtn.addEventListener("click", function () {
            if (currentSection === "profile") {
              // Validate personal information fields
              const firstName = document.querySelector(
                'input[placeholder="First Name"]'
              );
              const lastName = document.querySelector(
                'input[placeholder="Last Name"]'
              );
              const department = document.querySelector(
                'input[placeholder="Department"]'
              );

              // Check if any field is empty
              if (!firstName.value.trim()) {
                alert("Please enter your First Name");
                firstName.focus();
                return;
              }
              if (!lastName.value.trim()) {
                alert("Please enter your Last Name");
                lastName.focus();
                return;
              }
              if (!department.value.trim()) {
                alert("Please enter your Department");
                department.focus();
                return;
              }

              profileSection.style.display = "none";
              questionnaireSection.style.display = "block";
              currentSection = "questionnaire";
              prevBtn.style.display = "block";
              showQuestions(currentQuestionPage);
            } else {
              // Validate current page questions
              const start = currentQuestionPage * questionsPerPage;
              const end = Math.min(start + questionsPerPage, questions.length);
              let allAnswered = true;
              let firstUnanswered = null;

              for (let i = start; i < end; i++) {
                const questionNum = i + 1;
                const radios = document.getElementsByName(`q${questionNum}`);
                let isAnswered = false;

                for (const radio of radios) {
                  if (radio.checked) {
                    isAnswered = true;
                    break;
                  }
                }

                if (!isAnswered) {
                  allAnswered = false;
                  if (!firstUnanswered) {
                    firstUnanswered = questionNum;
                  }
                }
              }

              if (!allAnswered) {
                alert(
                  `Please answer all questions on this page. Question ${firstUnanswered} is not answered.`
                );
                const unansweredQuestion = document
                  .querySelector(`[name="q${firstUnanswered}"]`)
                  .closest(".question-item");
                unansweredQuestion.scrollIntoView({
                  behavior: "smooth",
                  block: "center",
                });
                return;
              }

              // Save current page answers
              for (let i = start; i < end; i++) {
                const questionNum = i + 1;
                const radios = document.getElementsByName(`q${questionNum}`);
                for (const radio of radios) {
                  if (radio.checked) {
                    savedAnswers[i] = radio.value === "agree" ? 1 : 0;
                    break;
                  }
                }
              }

              // Log current page answers
              logAnswers(currentQuestionPage);

              if (
                (currentQuestionPage + 1) * questionsPerPage <
                questions.length
              ) {
                currentQuestionPage++;
                showQuestions(currentQuestionPage);
              } else {
                // Check if all questions are answered before final submission
                if (savedAnswers.includes(null)) {
                  alert("Please answer all questions before submitting.");
                  return;
                }

                // Send answers to prediction API
                fetch("http://127.0.0.1:5000/predict", {
                  method: "POST",
                  headers: {
                    "Content-Type": "application/json",
                  },
                  body: JSON.stringify({ answers: savedAnswers }),
                })
                  .then((response) => response.json())
                  .then((data) => {
                    // Fetch courses and find matching learning style
                    fetch("http://127.0.0.1:8000/api/v1/courses")
                      .then((response) => response.json())
                      .then((coursesData) => {
                        // Find the course matching the predicted learning style
                        const matchingCourse = coursesData.data.find(
                          (course) =>
                            course.learning_style.style_name.toLowerCase() ===
                            data.learning_style.toLowerCase()
                        );

                        if (matchingCourse) {
                          // Get form data
                          const firstName = userData.first_name;
                          const lastName = userData.last_name;
                          const department = document.querySelector(
                            'input[placeholder="Department"]'
                          ).value;

                          // Store assessment results in database with course_id
                          fetch("http://127.0.0.1:8000/api/v1/assessment-results", {
                            method: "POST",
                            headers: {
                              "Content-Type": "application/json",
                              Accept: "application/json",
                            },
                            body: JSON.stringify({
                              first_name: firstName,
                              last_name: lastName,
                              department: department,
                              user_id: userData.user_id,
                              course_id: matchingCourse.course_id,
                              answers: {
                                answers: savedAnswers,
                              },
                              result: data,
                            }),
                          })
                          .then((response) => {
                            // Log the request payload
                            console.log('Request payload:', {
                              first_name: firstName,
                              last_name: lastName,
                              department: department,
                              user_id: userData.user_id,
                              course_id: matchingCourse.course_id,
                              answers: {
                                answers: savedAnswers,
                              },
                              result: data,
                            });

                            if (!response.ok) {
                              return response.json().then((err) => {
                                // Log the error details
                                console.error('Server validation errors:', err);
                                throw new Error(
                                  err.error
                                    ? JSON.stringify(err.error)
                                    : "Failed to store assessment results"
                                );
                              });
                                                         }
                             // Store the learning style in session storage to be used on the dashboard
                             sessionStorage.setItem('learning_style', data.learning_style.toLowerCase());
                             // Redirect to dashboard
                             window.location.href = "dashboard.html";
                           })
                           .catch((error) => {
                            console.error('Error storing assessment results:', error);
                            alert(
                              "An error occurred while storing your assessment results. Please try again."
                            );
                          });
                        } else {
                          console.error(
                            "No matching course found for learning style:",
                            data.learning_style
                          );
                          alert("No matching course found for your learning style. Please try again.");
                        }
                      })
                      .catch((error) => {
                        console.error("Error fetching courses:", error);
                        alert("An error occurred while fetching courses. Please try again.");
                      });
                  })
                  .catch((error) => {
                    console.error("Error:", error);
                    alert(
                      "An error occurred while processing your assessment. Please try again."
                    );
                  });
              }
            }

            if (
              (currentQuestionPage + 1) * questionsPerPage >=
              questions.length
            ) {
              nextBtn.textContent = "Submit";
            }
          });

          prevBtn.addEventListener("click", function () {
            if (currentQuestionPage === 0) {
              profileSection.style.display = "block";
              questionnaireSection.style.display = "none";
              currentSection = "profile";
              prevBtn.style.display = "none";
            } else {
              currentQuestionPage--;
              showQuestions(currentQuestionPage);
            }
            nextBtn.textContent = "Next";
            updateProgress();
          });
        }

        // We're removing this function as it will now be on the dashboard page
      });
    </script>
  </body>
</html>
